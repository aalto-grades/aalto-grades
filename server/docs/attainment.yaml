# SPDX-FileCopyrightText: 2023 The Aalto Grades Developers
#
# SPDX-License-Identifier: MIT
---
definitions:
  AttainmentId:
    type: integer
    description: Internal attainment database ID.
    format: int32
    minimum: 1
    example: 1

  AttainmentName:
    type: string
    decription: Name of the attainment.
    example: Exam

  Attainment:
    description: Course attainment information.
    type: object
    properties:
      id:
        $ref: '#/definitions/AttainmentId'
      courseId:
        $ref: '#/definitions/CourseId'
      name:
        $ref: '#/definitions/AttainmentName'
      daysValid:
        type: number
        decription: Number of days valid.
        minimum: 1
        example: 365
      archived:
        type: boolean
        description: If attainment has been archived
        example: false
    required:
      - id
      - courseId
      - name
      - daysValid
      - archived

  NewAttainment:
    description: Course attainment information.
    type: object
    properties:
      name:
        $ref: '#/definitions/AttainmentName'
      daysValid:
        type: number
        decription: Number of days valid.
        minimum: 1
        example: 365
    required:
      - name
      - daysValid

  EditAttainment:
    description: Course attainment information.
    type: object
    properties:
      name:
        $ref: '#/definitions/AttainmentName'
      daysValid:
        type: number
        decription: Number of days valid.
        minimum: 1
        example: 365
      archived:
        type: boolean
        description: If attainment has been archived
        example: false

/v1/courses/{courseId}/attainments:
  get:
    tags: [Attainment]
    description: Get all the attainments of a course.
    parameters:
      - $ref: '#/components/parameters/courseId'
    responses:
      200:
        description: Returns all attainments of the course.
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/definitions/Attainment'
      400:
        $ref: '#/components/responses/BadRequest'
      401:
        $ref: '#/components/responses/Unauthorized'
      403:
        $ref: '#/components/responses/Forbidden'
      404:
        $ref: '#/components/responses/NotFound'
    security:
      - cookieAuth: []
  post:
    tags: [Attainment]
    description: >
      Add an attainment to the course.
      Available only to admin users and teachers in charge of the course.
    parameters:
      - $ref: '#/components/parameters/courseId'
    requestBody:
      content:
        application/json:
          schema:
            $ref: '#/definitions/NewAttainment'
    responses:
      201:
        description: Attainment created.
        content:
          application/json:
            schema:
              $ref: '#/definitions/AttainmentId'
      400:
        $ref: '#/components/responses/BadRequest'
      401:
        $ref: '#/components/responses/Unauthorized'
      403:
        $ref: '#/components/responses/Forbidden'
      404:
        $ref: '#/components/responses/NotFound'
      409:
        $ref: '#/components/responses/Conflict'
    security:
      - cookieAuth: []

/v1/courses/{courseId}/attainments/{attainmentId}:
  put:
    tags: [Attainment]
    description: >
      Edit specified attainment.
      Available only to admin users and teachers in charge of the course.
    parameters:
      - $ref: '#/components/parameters/courseId'
      - $ref: '#/components/parameters/attainmentId'
    requestBody:
      content:
        application/json:
          schema:
            $ref: '#/definitions/EditAttainment'
    responses:
      200:
        description: Attainment updated.
      400:
        $ref: '#/components/responses/BadRequest'
      401:
        $ref: '#/components/responses/Unauthorized'
      403:
        $ref: '#/components/responses/Forbidden'
      404:
        $ref: '#/components/responses/NotFound'
      409:
        $ref: '#/components/responses/Conflict'
    security:
      - cookieAuth: []
  delete:
    tags: [Attainment]
    description: >
      Delete specified attainment.
      Available only to admin users and teachers in charge of the course.
    parameters:
      - $ref: '#/components/parameters/courseId'
      - $ref: '#/components/parameters/attainmentId'
    responses:
      200:
        description: Attainment deleted.
      400:
        $ref: '#/components/responses/BadRequest'
      401:
        $ref: '#/components/responses/Unauthorized'
      403:
        $ref: '#/components/responses/Forbidden'
      404:
        $ref: '#/components/responses/NotFound'
      409:
        $ref: '#/components/responses/Conflict'
    security:
      - cookieAuth: []
