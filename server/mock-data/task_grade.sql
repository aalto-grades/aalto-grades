-- SPDX-FileCopyrightText: 2024 The Ossi Developers
--
-- SPDX-License-Identifier: MIT

ALTER TABLE public.task_grade DISABLE TRIGGER ALL;

WITH vars AS (
  SELECT
    (SELECT id FROM public.course WHERE course_code='CS-A3456-DUMMY') as course_id,
    (SELECT id FROM public.user WHERE email='teacher@aalto.fi') as grader_id
),
course_parts AS (
  SELECT id, name FROM public.course_part WHERE course_id = (SELECT course_id FROM vars)
),
tasks AS (
  SELECT id, name, course_part_id FROM public.course_task WHERE course_part_id IN (SELECT id FROM course_parts)
)
INSERT INTO public.task_grade (user_id, course_task_id, grader_id, grade, date, expiry_date, created_at, updated_at)
SELECT
  u.id,
  t.id,
  (SELECT grader_id FROM vars),
  d.grade,
  NOW(),
  NULL,
  NOW(),
  NOW()
FROM
  (VALUES
    ('DUMMY-241142', 'Exercises 2024', 'Exercise 1', 7),
    ('DUMMY-241142', 'Exercises 2024', 'Exercise 2', 2),
    ('DUMMY-241142', 'Exam 2024', 'Exam points', 18),
    ('DUMMY-812472', 'Exercises 2024', 'Exercise 1', 4),
    ('DUMMY-812472', 'Exercises 2024', 'Exercise 2', 4),
    ('DUMMY-812472', 'Exam 2024', 'Exam points', 18),
    ('DUMMY-935116', 'Exercises 2024', 'Exercise 1', 7),
    ('DUMMY-935116', 'Exercises 2024', 'Exercise 2', 3),
    ('DUMMY-935116', 'Exam 2024', 'Exam points', 9),
    ('DUMMY-773858', 'Exercises 2024', 'Exercise 1', 9),
    ('DUMMY-773858', 'Exercises 2024', 'Exercise 2', 3),
    ('DUMMY-773858', 'Exam 2024', 'Exam points', 2),
    ('DUMMY-352772', 'Exercises 2024', 'Exercise 1', 5),
    ('DUMMY-352772', 'Exercises 2024', 'Exercise 2', 8),
    ('DUMMY-352772', 'Exam 2024', 'Exam points', 7),
    ('DUMMY-352772', 'Exercises 2024', 'Exercise 1', 1),
    ('DUMMY-352772', 'Exercises 2024', 'Exercise 2', 0),
    ('DUMMY-352772', 'Exam 2024', 'Exam points', 20),
    ('DUMMY-963929', 'Exercises 2024', 'Exercise 1', 7),
    ('DUMMY-963929', 'Exercises 2024', 'Exercise 2', 7),
    ('DUMMY-963929', 'Exam 2024', 'Exam points', 12),
    ('DUMMY-519334', 'Exercises 2024', 'Exercise 1', 7),
    ('DUMMY-519334', 'Exercises 2024', 'Exercise 2', 8),
    ('DUMMY-519334', 'Exam 2024', 'Exam points', 7),
    ('DUMMY-118345', 'Exercises 2024', 'Exercise 1', 1),
    ('DUMMY-118345', 'Exercises 2024', 'Exercise 2', 7),
    ('DUMMY-118345', 'Exam 2024', 'Exam points', 11),
    ('DUMMY-476617', 'Exercises 2024', 'Exercise 1', 10),
    ('DUMMY-476617', 'Exercises 2024', 'Exercise 2', 4),
    ('DUMMY-476617', 'Exam 2024', 'Exam points', 4),
    ('DUMMY-537522', 'Exercises 2024', 'Exercise 1', 4),
    ('DUMMY-537522', 'Exercises 2024', 'Exercise 2', 0),
    ('DUMMY-537522', 'Exam 2024', 'Exam points', 12),
    ('DUMMY-482499', 'Exercises 2024', 'Exercise 1', 2),
    ('DUMMY-482499', 'Exercises 2024', 'Exercise 2', 6),
    ('DUMMY-482499', 'Exam 2024', 'Exam points', 19),
    ('DUMMY-185228', 'Exercises 2024', 'Exercise 1', 8),
    ('DUMMY-185228', 'Exercises 2024', 'Exercise 2', 5),
    ('DUMMY-185228', 'Exam 2024', 'Exam points', 11),
    ('DUMMY-638843', 'Exercises 2024', 'Exercise 1', 3),
    ('DUMMY-638843', 'Exercises 2024', 'Exercise 2', 10),
    ('DUMMY-638843', 'Exam 2024', 'Exam points', 7),
    ('DUMMY-325235', 'Exercises 2024', 'Exercise 1', 1),
    ('DUMMY-325235', 'Exercises 2024', 'Exercise 2', 3),
    ('DUMMY-325235', 'Exam 2024', 'Exam points', 9),
    ('DUMMY-915741', 'Exercises 2024', 'Exercise 1', 7),
    ('DUMMY-915741', 'Exercises 2024', 'Exercise 2', 5),
    ('DUMMY-915741', 'Exam 2024', 'Exam points', 13),
    ('DUMMY-784619', 'Exercises 2024', 'Exercise 1', 7),
    ('DUMMY-784619', 'Exercises 2024', 'Exercise 2', 3),
    ('DUMMY-784619', 'Exam 2024', 'Exam points', 15),
    ('DUMMY-765877', 'Exercises 2024', 'Exercise 1', 1),
    ('DUMMY-765877', 'Exercises 2024', 'Exercise 2', 8),
    ('DUMMY-765877', 'Exam 2024', 'Exam points', 20),
    ('DUMMY-743554', 'Exercises 2024', 'Exercise 1', 3),
    ('DUMMY-743554', 'Exercises 2024', 'Exercise 2', 0),
    ('DUMMY-743554', 'Exam 2024', 'Exam points', 13),
    ('DUMMY-878552', 'Exercises 2024', 'Exercise 1', 2),
    ('DUMMY-878552', 'Exercises 2024', 'Exercise 2', 0),
    ('DUMMY-878552', 'Exam 2024', 'Exam points', 17),
    ('DUMMY-126693', 'Exercises 2024', 'Exercise 1', 7),
    ('DUMMY-126693', 'Exercises 2024', 'Exercise 2', 4),
    ('DUMMY-126693', 'Exam 2024', 'Exam points', 12),
    ('DUMMY-183958', 'Exercises 2024', 'Exercise 1', 0),
    ('DUMMY-183958', 'Exercises 2024', 'Exercise 2', 8),
    ('DUMMY-183958', 'Exam 2024', 'Exam points', 9),
    ('DUMMY-112239', 'Exercises 2024', 'Exercise 1', 8),
    ('DUMMY-112239', 'Exercises 2024', 'Exercise 2', 10),
    ('DUMMY-112239', 'Exam 2024', 'Exam points', 10),
    ('DUMMY-261258', 'Exercises 2024', 'Exercise 1', 7),
    ('DUMMY-261258', 'Exercises 2024', 'Exercise 2', 7),
    ('DUMMY-261258', 'Exam 2024', 'Exam points', 5),
    ('DUMMY-522214', 'Exercises 2024', 'Exercise 1', 4),
    ('DUMMY-522214', 'Exercises 2024', 'Exercise 2', 1),
    ('DUMMY-522214', 'Exam 2024', 'Exam points', 9),
    ('DUMMY-949181', 'Exercises 2024', 'Exercise 1', 10),
    ('DUMMY-949181', 'Exercises 2024', 'Exercise 2', 3),
    ('DUMMY-949181', 'Exam 2024', 'Exam points', 9),
    ('DUMMY-655233', 'Exercises 2024', 'Exercise 1', 4),
    ('DUMMY-655233', 'Exercises 2024', 'Exercise 2', 3),
    ('DUMMY-655233', 'Exam 2024', 'Exam points', 1),
    ('DUMMY-167178', 'Exercises 2024', 'Exercise 1', 2),
    ('DUMMY-167178', 'Exercises 2024', 'Exercise 2', 1),
    ('DUMMY-167178', 'Exam 2024', 'Exam points', 10),
    ('DUMMY-511733', 'Exercises 2024', 'Exercise 1', 2),
    ('DUMMY-511733', 'Exercises 2024', 'Exercise 2', 2),
    ('DUMMY-511733', 'Exam 2024', 'Exam points', 12),
    ('DUMMY-827525', 'Exercises 2024', 'Exercise 1', 1),
    ('DUMMY-827525', 'Exercises 2024', 'Exercise 2', 8),
    ('DUMMY-827525', 'Exam 2024', 'Exam points', 17),
    ('DUMMY-545761', 'Exercises 2024', 'Exercise 1', 10),
    ('DUMMY-545761', 'Exercises 2024', 'Exercise 2', 9),
    ('DUMMY-545761', 'Exam 2024', 'Exam points', 5),
    ('DUMMY-169639', 'Exercises 2024', 'Exercise 1', 5),
    ('DUMMY-169639', 'Exercises 2024', 'Exercise 2', 10),
    ('DUMMY-169639', 'Exam 2024', 'Exam points', 3),
    ('DUMMY-753213', 'Exercises 2024', 'Exercise 1', 2),
    ('DUMMY-753213', 'Exercises 2024', 'Exercise 2', 8),
    ('DUMMY-753213', 'Exam 2024', 'Exam points', 17),
    ('DUMMY-531231', 'Exercises 2024', 'Exercise 1', 0),
    ('DUMMY-531231', 'Exercises 2024', 'Exercise 2', 3),
    ('DUMMY-531231', 'Exam 2024', 'Exam points', 1),
    ('DUMMY-349825', 'Exercises 2024', 'Exercise 1', 2),
    ('DUMMY-349825', 'Exercises 2024', 'Exercise 2', 7),
    ('DUMMY-349825', 'Exam 2024', 'Exam points', 15),
    ('DUMMY-573857', 'Exercises 2024', 'Exercise 1', 0),
    ('DUMMY-573857', 'Exercises 2024', 'Exercise 2', 8),
    ('DUMMY-573857', 'Exam 2024', 'Exam points', 10),
    ('DUMMY-866567', 'Exercises 2024', 'Exercise 1', 9),
    ('DUMMY-866567', 'Exercises 2024', 'Exercise 2', 8),
    ('DUMMY-866567', 'Exam 2024', 'Exam points', 5),
    ('DUMMY-344625', 'Exercises 2024', 'Exercise 1', 3),
    ('DUMMY-344625', 'Exercises 2024', 'Exercise 2', 0),
    ('DUMMY-344625', 'Exam 2024', 'Exam points', 7),
    ('DUMMY-216384', 'Exercises 2024', 'Exercise 1', 3),
    ('DUMMY-216384', 'Exercises 2024', 'Exercise 2', 6),
    ('DUMMY-216384', 'Exam 2024', 'Exam points', 1),
    ('DUMMY-849946', 'Exercises 2024', 'Exercise 1', 9),
    ('DUMMY-849946', 'Exercises 2024', 'Exercise 2', 1),
    ('DUMMY-849946', 'Exam 2024', 'Exam points', 9),
    ('DUMMY-446858', 'Exercises 2024', 'Exercise 1', 6),
    ('DUMMY-446858', 'Exercises 2024', 'Exercise 2', 10),
    ('DUMMY-446858', 'Exam 2024', 'Exam points', 4),
    ('DUMMY-279337', 'Exercises 2024', 'Exercise 1', 6),
    ('DUMMY-279337', 'Exercises 2024', 'Exercise 2', 1),
    ('DUMMY-279337', 'Exam 2024', 'Exam points', 12),
    ('DUMMY-156214', 'Exercises 2024', 'Exercise 1', 2),
    ('DUMMY-156214', 'Exercises 2024', 'Exercise 2', 3),
    ('DUMMY-156214', 'Exam 2024', 'Exam points', 4),
    ('DUMMY-585911', 'Exercises 2024', 'Exercise 1', 4),
    ('DUMMY-585911', 'Exercises 2024', 'Exercise 2', 7),
    ('DUMMY-585911', 'Exam 2024', 'Exam points', 11),
    ('DUMMY-793673', 'Exercises 2024', 'Exercise 1', 7),
    ('DUMMY-793673', 'Exercises 2024', 'Exercise 2', 10),
    ('DUMMY-793673', 'Exam 2024', 'Exam points', 1),
    ('DUMMY-184243', 'Exercises 2024', 'Exercise 1', 8),
    ('DUMMY-184243', 'Exercises 2024', 'Exercise 2', 5),
    ('DUMMY-184243', 'Exam 2024', 'Exam points', 6),
    ('DUMMY-581953', 'Exercises 2024', 'Exercise 1', 2),
    ('DUMMY-581953', 'Exercises 2024', 'Exercise 2', 9),
    ('DUMMY-581953', 'Exam 2024', 'Exam points', 3),
    ('DUMMY-348576', 'Exercises 2024', 'Exercise 1', 0),
    ('DUMMY-348576', 'Exercises 2024', 'Exercise 2', 1),
    ('DUMMY-348576', 'Exam 2024', 'Exam points', 16),
    ('DUMMY-495298', 'Exercises 2024', 'Exercise 1', 4),
    ('DUMMY-495298', 'Exercises 2024', 'Exercise 2', 0),
    ('DUMMY-495298', 'Exam 2024', 'Exam points', 13),
    ('DUMMY-826139', 'Exercises 2024', 'Exercise 1', 4),
    ('DUMMY-826139', 'Exercises 2024', 'Exercise 2', 3),
    ('DUMMY-826139', 'Exam 2024', 'Exam points', 16)
  ) AS d (student_number, part_name, task_name, grade)
JOIN public.user u ON u.student_number = d.student_number
JOIN course_parts cp ON cp.name = d.part_name
JOIN tasks t ON t.name = d.task_name AND t.course_part_id = cp.id;

ALTER TABLE public.task_grade ENABLE TRIGGER ALL;
