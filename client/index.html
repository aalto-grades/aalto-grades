<!--
SPDX-FileCopyrightText: 2024 The Ossi Developers

SPDX-License-Identifier: MIT
-->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script>
      // Matomo
      var _paq = (window._paq = window._paq || []);
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function () {
        var u = '//matomo.cs.aalto.fi/';
        _paq.push(['setTrackerUrl', u + 'matomo.php']);
        _paq.push(['setSiteId', '3']);
        var d = document,
          g = d.createElement('script'),
          s = d.getElementsByTagName('script')[0];
        g.async = true;
        g.src = u + 'matomo.js';
        s.parentNode.insertBefore(g, s);
      })();
      // End Matomo Code

      // Browser Warning, current E2E testing covers only firefox and chromium
      document.addEventListener("DOMContentLoaded", function () {
        function detectUnsupportedBrowser() {
          if (localStorage.getItem("dismissCompatibilityWarning")) return;
          var match = navigator.userAgent.match(/(chrome|firefox|chromium)\/?\s*(\d+)/i);
          if (!match) {
            document.getElementById("browser-warning").style.display = "flex";
          }
        }
        function dismissWarning() {
          document.getElementById("browser-warning").style.display = "none";
          localStorage.setItem("dismissCompatibilityWarning", "true");
        }
        detectUnsupportedBrowser();
        window.dismissWarning = dismissWarning;
      });
    </script>
    <title>Ossi</title>
  </head>

  <body>
    <div id="browser-warning" style="display: none; padding: 20px; text-align: center;">
      ⚠️ Unsupported Browser Detected!
      This site may not function properly in your browser.
      Ossi is tested only with Firefox and Chromium-based browsers.
      <button onclick="dismissWarning()">Dismiss</button>
    </div>
    <div id="root"></div>
    <script type="module" src="/src/index.tsx"></script>
  </body>
</html>
